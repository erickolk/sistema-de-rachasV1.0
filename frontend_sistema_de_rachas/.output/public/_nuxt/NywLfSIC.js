import{s as oe}from"./By36ONhC.js";import{s as se}from"./C4kqpmWP.js";import{s as ne}from"./BjSk6R96.js";import{s as re,a as le}from"./CyxjX5yh.js";import{s as ie}from"./BKAYiMY5.js";import{a as de}from"./DDSFaLPl.js";import{B as ce,c as x,o as D,C as M,a,z as w,A as R,a4 as H,m as ue,Z as me,v as pe,r as p,a5 as ve,p as fe,b as s,w as i,q as be,$ as ye,d as v,t as f,_ as ge}from"./DJoCQzgD.js";import{a as he,g as we,m as xe}from"./BhaXg5TM.js";import{g as De,a as $e,d as Ce}from"./Ct042bsD.js";import"./CZGk8w3r.js";import"./1R96cE9n.js";import"./z94W3lgw.js";import"./D3BmJwgN.js";import"./D781cylh.js";import"./D8NCiHfp.js";import"./BF-rSLMc.js";import"./BpnfKLQc.js";import"./D630mdnj.js";import"./BcjbkUIV.js";import"./Lk2AerRB.js";import"./DDrKUIu6.js";var Te=function(c){var d=c.dt;return`
.p-card {
    background: `.concat(d("card.background"),`;
    color: `).concat(d("card.color"),`;
    box-shadow: `).concat(d("card.shadow"),`;
    border-radius: `).concat(d("card.border.radius"),`;
    display: flex;
    flex-direction: column;
}

.p-card-caption {
    display: flex;
    flex-direction: column;
    gap: `).concat(d("card.caption.gap"),`;
}

.p-card-body {
    padding: `).concat(d("card.body.padding"),`;
    display: flex;
    flex-direction: column;
    gap: `).concat(d("card.body.gap"),`;
}

.p-card-title {
    font-size: `).concat(d("card.title.font.size"),`;
    font-weight: `).concat(d("card.title.font.weight"),`;
}

.p-card-subtitle {
    color: `).concat(d("card.subtitle.color"),`;
}
`)},Me={root:"p-card p-component",header:"p-card-header",body:"p-card-body",caption:"p-card-caption",title:"p-card-title",subtitle:"p-card-subtitle",content:"p-card-content",footer:"p-card-footer"},Ve=ce.extend({name:"card",theme:Te,classes:Me}),ke={name:"BaseCard",extends:de,style:Ve,provide:function(){return{$pcCard:this,$parentInstance:this}}},W={name:"Card",extends:ke,inheritAttrs:!1};function Pe(n,c,d,V,k,F){return D(),x("div",w({class:n.cx("root")},n.ptmi("root")),[n.$slots.header?(D(),x("div",w({key:0,class:n.cx("header")},n.ptm("header")),[R(n.$slots,"header")],16)):M("",!0),a("div",w({class:n.cx("body")},n.ptm("body")),[n.$slots.title||n.$slots.subtitle?(D(),x("div",w({key:0,class:n.cx("caption")},n.ptm("caption")),[n.$slots.title?(D(),x("div",w({key:0,class:n.cx("title")},n.ptm("title")),[R(n.$slots,"title")],16)):M("",!0),n.$slots.subtitle?(D(),x("div",w({key:1,class:n.cx("subtitle")},n.ptm("subtitle")),[R(n.$slots,"subtitle")],16)):M("",!0)],16)):M("",!0),a("div",w({class:n.cx("content")},n.ptm("content")),[R(n.$slots,"content")],16),n.$slots.footer?(D(),x("div",w({key:1,class:n.cx("footer")},n.ptm("footer")),[R(n.$slots,"footer")],16)):M("",!0)],16)],16)}W.render=Pe;const q=async()=>{const{$api:n}=H();try{return(await n.get("/payments/owner")).data}catch(c){throw console.error("Erro ao buscar pagamentos:",c),c}},_e=async()=>{const{$api:n}=H();try{return(await n.get("/payments/owner/dashboard")).data}catch(c){throw console.error("Erro ao buscar relatório financeiro:",c),c}},Re={class:"container p-4 mt-8"},Se={class:"mb-16 pb-8 border-b border-b-zinc-700"},Be={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Fe={class:"mb-8 pb-8 border-b border-b-zinc-700"},Ne={class:"flex justify-between items-center mb-8"},Ae={class:"flex justify-end"},Ee={class:"mb-8 pb-8 border-b border-b-zinc-700"},Ie={class:"mb-8 pb-8 border-b border-b-zinc-700"},ze={class:"mb-8 pb-8 border-b border-b-zinc-700"},je={class:"p-4"},Ue={class:"flex gap-6"},Oe={class:"flex-1 bg-white rounded-lg p-4 shadow-sm"},Le={class:"space-y-4"},qe={class:"mt-1 p-3 bg-gray-50 rounded-md"},He={class:"mt-1 p-3 bg-gray-50 rounded-md font-mono text-sm"},We={class:"mt-1 p-3 bg-gray-50 rounded-md font-semibold"},Ke={class:"flex-1 bg-white rounded-lg p-4 shadow-sm"},Xe={class:"space-y-4"},Ye={class:"mt-1"},Ze={key:0,class:"text-red-500 block mt-1"},Ge={class:"mt-1 p-3 bg-emerald-50 rounded-md"},Je={class:"text-lg font-semibold text-emerald-700"},Qe={class:"mt-6"},et=ue({__name:"index",setup(n){const c=ye(),d=me(),V=pe(),k=p(),F=p(0),N=p([]),A=p([]),z=p([]),S=p([]),B=p(!1),g=p(null),h=p({label:"Valor Fixo",value:"valor"}),u=p(0),K=[{label:"Valor Fixo",value:"valor"},{label:"Porcentagem",value:"porcentagem"}],$=p({totalMatches:0,totalDiscounts:0,totalRevenue:0,unpaidMatches:0}),P=t=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(t),E=ve(()=>{var o;const t=((o=C.value)==null?void 0:o.rentalValue)||0;let e=t;if(h.value.value==="porcentagem"){const l=Math.min(u.value,100);e=t*(1-l/100)}else{const l=Math.min(u.value,t);e=t-l}return Math.max(e,0)}),C=p(),X=()=>{u.value<0&&(u.value=0,V.add({severity:"warn",summary:"Valor inválido",detail:"O desconto não pode ser negativo",life:3e3})),h.value.value==="porcentagem"&&u.value>100&&(u.value=100,V.add({severity:"warn",summary:"Valor inválido",detail:"O desconto máximo é 100%",life:3e3}))},Y=t=>{c.push(`/fields/${t.id}/edit`)},T=t=>{if(!t)return"Hora não disponível";if(typeof t=="object"&&"hours"in t&&"minutes"in t){const e=String(t.hours).padStart(2,"0"),o=String(t.minutes).padStart(2,"0");return`${e}:${o}`}return typeof t=="string"?t.substring(0,5):"Hora não disponível"},j=t=>{if(!t)return"Data não disponível";try{const e=new Date(t);if(isNaN(e.getTime()))return"Data não disponível";const o=String(e.getDate()).padStart(2,"0"),l=String(e.getMonth()+1).padStart(2,"0"),y=e.getFullYear();return`${o}/${l}/${y}`}catch{return"Data não disponível"}},U=async()=>{try{const t=await he();t&&Array.isArray(t)&&(N.value=t.filter(e=>e&&e.schedules&&e.schedules.length>0).sort((e,o)=>{var r,b;const l=(r=e.schedules[0])!=null&&r.day?new Date(e.schedules[0].day).getTime():0,y=(b=o.schedules[0])!=null&&b.day?new Date(o.schedules[0].day).getTime():0;return l-y}).map(e=>{const o=e.schedules[0];return{id:e.id,name:e.name||"Nome não disponível",date:j(o==null?void 0:o.day)||"Data não disponível",schedules:`${T(o==null?void 0:o.startTime)} às ${T(o==null?void 0:o.finishTime)}`,startTime:T(o==null?void 0:o.startTime),finishTime:T(o==null?void 0:o.finishTime),field:e.soccerField||"Campo não especificado",paid:e.paid,user:e.user}}))}catch(t){console.error("Erro ao carregar partidas não pagas:",t),N.value=[]}},Z=async()=>{try{const t=await we();t&&Array.isArray(t)&&(F.value=t.length,A.value=t.filter(e=>e&&e.schedules&&e.schedules.length>0).sort((e,o)=>{var r,b;const l=(r=e.schedules[0])!=null&&r.day?new Date(e.schedules[0].day).getTime():0,y=(b=o.schedules[0])!=null&&b.day?new Date(o.schedules[0].day).getTime():0;return l-y}).map(e=>{var l;const o=e.schedules[0];return{name:e.name||"Nome não disponível",date:j(o==null?void 0:o.day)||"Data não disponível",startTime:T(o==null?void 0:o.startTime),finishTime:T(o==null?void 0:o.finishTime),field:((l=e.soccerField)==null?void 0:l.name)||"Campo não especificado",paid:e.paid}}))}catch(t){console.error("Erro ao carregar partidas:",t),A.value=[]}},G=async t=>{g.value=t,g.value&&g.value.field&&(C.value=await $e(g.value.field._id)),B.value=!0},J=async()=>{try{const t=C.value.rentalValue;let e=0;if(h.value.value==="porcentagem"){const y=Math.min(u.value,100);e=t*(y/100)}else e=Math.min(u.value,t);const o={paymentDate:new Date().toISOString(),paymentMethod:"pix",match:g.value.id,user:g.value.user.id,amount:t,discount:e,totalAmountWithDiscount:E.value};await xe(o),await U();const l=await q();S.value=l.data,await O(),B.value=!1,V.add({severity:"success",summary:"Sucesso",detail:"Pagamento confirmado com sucesso!",life:3e3})}catch(t){console.error("Erro ao realizar pagamento:",t),V.add({severity:"error",summary:"Erro",detail:"Não foi possível realizar o pagamento. Tente novamente.",life:3e3})}},Q=t=>{d.require({message:"Você tem certeza que deseja excluir este item?",header:"Confirmação",icon:"pi pi-exclamation-triangle",acceptLabel:"Confirmar",rejectLabel:"Cancelar",acceptClass:"p-button-primary",rejectClass:"p-button-secondary",accept:async()=>{try{await Ce(t.id),z.value=z.value.filter(e=>e.id!==t.id)}catch(e){console.error("Erro ao deletar campo",e)}}})},O=async()=>{try{const{data:t}=await _e();t?$.value={totalMatches:t.totalMatches||0,totalDiscounts:t.totalDiscounts||0,totalRevenue:t.totalRevenue||0,unpaidMatches:t.unpaidMatches||0}:$.value={totalMatches:0,totalDiscounts:0,totalRevenue:0,unpaidMatches:0}}catch(t){console.error("Erro ao carregar relatório financeiro:",t),$.value={totalMatches:0,totalDiscounts:0,totalRevenue:0,unpaidMatches:0}}};return fe(async()=>{try{await Z(),await U();try{const t=await q();S.value=(t==null?void 0:t.data)||[]}catch(t){console.error("Erro ao carregar pagamentos:",t),S.value=[]}try{k.value=await De()}catch(t){console.error("Erro ao carregar campos:",t),k.value=[]}await O()}catch(t){console.error("Erro ao carregar dashboard:",t)}}),(t,e)=>{const o=W,l=ie,y=be("RouterLink"),r=le,b=re,ee=ne,te=se,ae=oe;return D(),x("div",null,[a("div",Re,[a("div",Se,[e[9]||(e[9]=a("h1",{class:"text-2xl font-bold mb-4"},"Dashboard",-1)),a("div",Be,[a("div",null,[s(o,null,{title:i(()=>e[3]||(e[3]=[a("i",{class:"pi pi-map-marker mr-2"},null,-1),v("Total de Campos ")])),content:i(()=>{var m;return[v(f(((m=k.value)==null?void 0:m.length)||0),1)]}),_:1})]),a("div",null,[s(o,null,{title:i(()=>e[4]||(e[4]=[a("i",{class:"pi pi-calendar mr-2"},null,-1),v("Partidas Agendadas ")])),content:i(()=>[v(f(F.value),1)]),_:1})]),a("div",null,[s(o,null,{title:i(()=>e[5]||(e[5]=[a("i",{class:"pi pi-check-circle mr-2"},null,-1),v("Partidas Pagas ")])),content:i(()=>[v(f($.value.totalMatches),1)]),_:1})]),a("div",null,[s(o,null,{title:i(()=>e[6]||(e[6]=[a("i",{class:"pi pi-money-bill mr-2"},null,-1),v("Total Recebido ")])),content:i(()=>[v(f(P($.value.totalRevenue)),1)]),_:1})]),a("div",null,[s(o,null,{title:i(()=>e[7]||(e[7]=[a("i",{class:"pi pi-percentage mr-2"},null,-1),v("Total em Descontos ")])),content:i(()=>[v(f(P($.value.totalDiscounts)),1)]),_:1})]),a("div",null,[s(o,null,{title:i(()=>e[8]||(e[8]=[a("i",{class:"pi pi-clock mr-2"},null,-1),v("Pagamentos Pendentes ")])),content:i(()=>[v(f($.value.unpaidMatches),1)]),_:1})])])]),a("div",Fe,[a("div",Ne,[e[10]||(e[10]=a("h2",{class:"text-xl font-semibold"},"Meus Campos",-1)),s(y,{to:{name:"fields-register"}},{default:i(()=>[s(l,{icon:"pi pi-plus",label:"Adicionar Campo"})]),_:1})]),s(b,{value:k.value||[]},{default:i(()=>[s(r,{field:"name",header:"Nome"}),s(r,{field:"pixKey",header:"Chave PIX"}),s(r,{field:"rentalValue",header:"Valor Aluguel"}),s(r,{field:"workStartTime",header:"Início Expediente"}),s(r,{field:"workFinishTime",header:"Fim Expediente"}),s(r,null,{body:i(m=>[a("div",Ae,[s(l,{icon:"pi pi-pencil",class:"p-button-rounded p-button-success mr-2",onClick:_=>Y(m.data)},null,8,["onClick"]),s(l,{icon:"pi pi-times",class:"p-button-rounded p-button-danger",onClick:_=>Q(m.data)},null,8,["onClick"])])]),_:1})]),_:1},8,["value"])]),a("div",Ee,[e[11]||(e[11]=a("div",{class:"flex justify-between items-center mb-8"},[a("h2",{class:"text-xl font-semibold"},"Próximas partidas")],-1)),s(b,{value:A.value,rows:5},{default:i(()=>[s(r,{field:"name",header:"Nome"}),s(r,{field:"date",header:"Data"}),s(r,{field:"startTime",header:"Início"}),s(r,{field:"finishTime",header:"Fim"}),s(r,{field:"field",header:"Campo"}),s(r,{field:"paid",header:"Pagamento"})]),_:1},8,["value"])]),a("div",Ie,[e[12]||(e[12]=a("div",{class:"flex justify-between items-center mb-8"},[a("h2",{class:"text-xl font-semibold"},"Pagamentos pendentes")],-1)),s(b,{value:N.value,rows:5},{default:i(()=>[s(r,{field:"id",header:"ID"}),s(r,{field:"name",header:"Nome"}),s(r,{field:"date",header:"Data"}),s(r,{field:"schedules",header:"Horário"}),s(r,{field:"paid",header:"Pagamento"},{body:i(m=>[s(l,{label:"Realizar Pagamento",onClick:_=>G(m.data)},null,8,["onClick"])]),_:1})]),_:1},8,["value"])]),a("div",ze,[e[13]||(e[13]=a("div",{class:"flex justify-between items-center mb-8"},[a("h2",{class:"text-xl font-semibold"},"Pagamentos recebidos")],-1)),s(b,{value:S.value,rows:5},{default:i(()=>[s(r,{field:"match.id",header:"ID da Partida"}),s(r,{field:"match.name",header:"Nome da Partida"}),s(r,{field:"match.soccerField.name",header:"Campo"}),s(r,{field:"user.name",header:"Usuário"}),s(r,{field:"paymentDate",header:"Data de Pagamento"}),s(r,{field:"formattedTotalAmountWithDiscount",header:"Total"}),s(r,{field:"paymentMethod",header:"Método de Pagamento"})]),_:1},8,["value"])])]),s(ae,{visible:B.value,"onUpdate:visible":e[2]||(e[2]=m=>B.value=m),modal:"",header:"Confirmação de Pagamento",class:"payment-dialog"},{default:i(()=>{var m,_,L;return[a("div",je,[a("div",Ue,[a("div",Oe,[e[17]||(e[17]=a("h3",{class:"text-lg font-semibold mb-4"},"Detalhes da Partida",-1)),a("div",Le,[a("div",null,[e[14]||(e[14]=a("label",{class:"text-sm text-gray-600"},"Nome da Partida",-1)),a("div",qe,f(g.value.name),1)]),a("div",null,[e[15]||(e[15]=a("label",{class:"text-sm text-gray-600"},"ID da Partida",-1)),a("div",He,f(g.value.id),1)]),a("div",null,[e[16]||(e[16]=a("label",{class:"text-sm text-gray-600"},"Valor Original",-1)),a("div",We,f(P(C.value.rentalValue)),1)])])]),a("div",Ke,[e[21]||(e[21]=a("h3",{class:"text-lg font-semibold mb-4"},"Configurar Desconto",-1)),a("div",Xe,[a("div",null,[e[18]||(e[18]=a("label",{class:"text-sm text-gray-600"},"Tipo de Desconto",-1)),s(ee,{modelValue:h.value,"onUpdate:modelValue":e[0]||(e[0]=I=>h.value=I),options:K,optionLabel:"label",class:"w-full mt-1"},null,8,["modelValue"])]),a("div",null,[e[19]||(e[19]=a("label",{class:"text-sm text-gray-600"},"Valor do Desconto",-1)),a("div",Ye,[s(te,{modelValue:u.value,"onUpdate:modelValue":[e[1]||(e[1]=I=>u.value=I),X],min:0,max:h.value.value==="porcentagem"?100:(m=C.value)==null?void 0:m.rentalValue,mode:"currency",currency:"BRL",locale:"pt-BR",class:"w-full"},null,8,["modelValue","max"]),u.value>(h.value.value==="porcentagem"?100:(_=C.value)==null?void 0:_.rentalValue)?(D(),x("small",Ze," Desconto máximo permitido: "+f(h.value.value==="porcentagem"?"100%":P((L=C.value)==null?void 0:L.rentalValue)),1)):M("",!0)])]),a("div",null,[e[20]||(e[20]=a("label",{class:"text-sm text-gray-600"},"Total com Desconto",-1)),a("div",Ge,[a("span",Je,f(P(E.value)),1)])])]),a("div",Qe,[s(l,{label:"Confirmar Pagamento",icon:"pi pi-check",class:"w-full p-button-success",onClick:J,disabled:E.value<=0||u.value<0},null,8,["disabled"])])])])])]}),_:1},8,["visible"])])}}}),Dt=ge(et,[["__scopeId","data-v-0a19c02f"]]);export{Dt as default};
